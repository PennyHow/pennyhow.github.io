---
layout: post
title: Introducing PyTrx
date: 2018-07-27 11:09
author: pennyhow
comments: true
categories: [All blog posts, Canon, feature tracking, glacier, glaciology, kronebreen, meltwater plume, optical flow, phd, PhD update, photography, Programming, python, PyTrx, research, supraglacial lake, Svalbard, tunabreen]
---
<p style="text-align:justify;"><strong><span style="text-decoration:underline;"><a href="https://github.com/PennyHow/PyTrx" target="_blank" rel="noopener">The PyTrx toolbox is now released</a></span> along with the corresponding methods paper, which is currently in the open review process for Geoscientific Instrumentation, Methods and Data Systems.</strong> We have been writing this toolbox since 2014, where motivation to develop such a product was first cultivated.</p>
<p style="text-align:justify;">Back then, we had started to collect time-lapse imagery from tidewater glaciers in Svalbard. After the first melt season, I was inundated with imagery that provided rich data sets from which I could obtain various pieces of information, such as glacier surface velocity, change in terminus position over time, surface lake drainage, and meltwater plume extents.</p>


[caption id="attachment_756" align="alignnone" width="5171"]<img class="alignnone size-full wp-image-756" src="https://pennyhow.files.wordpress.com/2015/10/0064-e1443897885376.jpg" alt="Surface lakes on Kronebreen, captured using one of our time-lapse cameras (camera 4b). These lakes are indicative of conditions at the bed of the glacier" width="5171" height="2721" /> An image from one of our time-lapse cameras placed at Kronebreen, looking at surface lake drainage in the upper part of the glacier tongue.[/caption]
<p style="text-align:justify;">After scouring the internet and trawling through all the literature I could find, I realised that there were no available glaciology tools for processing all of these types of data from oblique imagery. Most were written in Matlab, a programming language I shy away from given that it is not open source. Some tools were wrapped in GUIs (Graphical User Interfaces) which meant I couldn't modify the source code for my own needs. And most were tailored for deriving velocities via feature tracking, which was only one of the aspects that I wanted to investigate.</p>
<p style="text-align:justify;"><strong>We realised that there was a gap in glaciology for an alternative, open-source toolbox that could be used for deriving a multitude of measurements from oblique glacial imagery; hence why we developed PyTrx.</strong></p>
<p style="text-align:justify;">PyTrx serves as a Python-alternative toolbox for deriving velocities, surface areas and line measurements from oblique glacial imagery. It has been developed with object-oriented design, meaning that the core functions are wrapped in callable-objects, which make it more accessible to beginners in programming whilst also serving those more experienced. It is similar to other toolboxes in that it has feature-tracking and georectification functionality, but it also has key features which differentiate it from others:</p>
<p style="text-align:justify;"><strong>1. Sparse feature-tracking with Optical Flow.</strong> In PyTrx, features are first selected  in Image 1 based on corner coherency. Up to 50,000 points are selected as a default. These points are then tracked to Image 2 using Optical Flow. This is typically used for detecting motion in video sequences, and is used in PyTrx to measure the apparent motion of the selected points between Image 1 and Image 2.</p>
<p style="text-align:justify;"><strong>2. Forward-backward feature-tracking.</strong> PyTrx employs a forward-backward tracking approach (<span style="text-decoration:underline;"><strong><a href="https://ieeexplore.ieee.org/document/5596017/" target="_blank" rel="noopener">Kalal et al., 2010</a></strong></span>) to ensure replicability and precision in deriving velocities. Specifically, selected points are tracked forward from Image 1 to Image 2 firstly. These same points are subsequently tracked backwards from Image 2 to Image 1. In theory, the backwards tracked points should be in the same location as those initially selected in Image 1, and points can be filtered based on this principle.</p>
<p style="text-align:justify;"><strong>3. Automated surface area detection.</strong> PyTrx can be used to detect areas of interest in oblique imagery. Areas are defined according to pixel intensities, which can be optimised using the image enhancement functions included in PyTrx. These image enhancement functions include image band (RGB) selection and brightness/contrast modifications (with diff, phi, and theta variables). This has been used for detecting changes in supraglacial lake areas, exploiting the pixel intensity differences between lake and ice (<span style="text-decoration:underline;"><strong><a href="https://www.the-cryosphere.net/11/2691/2017/" target="_blank" rel="noopener">How et al., 2017</a></strong></span>).</p>
<p style="text-align:justify;"><strong>4. Line measurements.</strong> PyTrx can be used to manually defined line objects, such as terminus profiles. Users define lines in the image scene on a click-by-click basis, which are subsequently transformed to xyz coordinates using PyTrx's georectification functionality. Areas can also be defined in this manner also, which is useful when automated detection is not ideal (e.g. when defining meltwater plumes, where glare and surface roughness from the fjord water often proves problematic).</p>
<p style="text-align:justify;">PyTrx is hosted in a repository on GitHub for easy access and continued development. <strong>Whilst PyTrx is in a distributable state and user-friendly, we know that is not always perfect.</strong> There will also be things that we can develop and improve, which we hope will be encouraged by our users.</p>


<hr />

<h3>Relevant Links</h3>
<span style="text-decoration:underline;"><strong><a href="https://github.com/PennyHow/PyTrx" target="_blank" rel="noopener">PyTrx on GitHub</a></strong></span> - Where the PyTrx toolbox is hosted online, free to download
<p style="text-align:justify;"><strong><span style="text-decoration:underline;"><a href="https://www.the-cryosphere.net/11/2691/2017/" target="_blank" rel="noopener">How et al., 2017</a></span> - </strong>PyTrx used to measure supraglacial lake drainage and meltwater plume variation, as part of the wider study examining the subglacial hydrology of Kronebreen, Svalbard</p>
There are other useful software available for terrestrial photogrammetry in glaciology:
<span style="text-decoration:underline;"><strong><a href="https://www.lancaster.ac.uk/staff/jamesm/software/pointcatcher.htm" target="_blank" rel="noopener">Pointcatcher</a></strong></span> - Matlab-based GUI toolbox for feature-tracking and georectification
<span style="text-decoration:underline;"><strong><a href="https://imgraft.glaciology.net/" target="_blank" rel="noopener">ImGRAFT</a></strong></span> - Matlab toolbox for feature-tracking and georectification
<span style="text-decoration:underline;"><strong><a href="https://www.mn.uio.no/geo/english/research/projects/icemass/cias/" target="_blank" rel="noopener">CIAS</a></strong></span> - IDL gui for feature-tracking
<span style="text-decoration:underline;"><strong><a href="https://www.geosci-model-dev.net/9/307/2016/" target="_blank" rel="noopener">PRACTISE</a></strong></span> - Matlab toolbox for georectification
